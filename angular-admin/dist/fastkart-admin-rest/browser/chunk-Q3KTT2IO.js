import{$b as L,Da as b,Yb as g,Zb as R,_b as E,a as u,ac as _,bc as j,cb as $,cc as k,dc as A,ec as I,fc as D,gc as B,hc as C,k as x,m as s,n as U,p as S}from"./chunk-AYDE6MWJ.js";import{$ as w,V as d,a as l,b as h,ca as m,n as c,xc as y}from"./chunk-RFGELG3T.js";var F=(()=>{let e=class e{constructor(t){this.http=t}getProducts(t){return this.http.get(`${u.URL}/product`,{params:t})}createProduct(t){return this.http.post(`${u.URL}/product`,t)}editProduct(t){return this.http.get(`${u.URL}/product/${t}`)}updateProduct(t,o){return this.http.put(`${u.URL}/product/${t}`,o)}updateProductStatus(t,o){return this.http.put(`${u.URL}/product/${t}/${o}`,{})}approveProductStatus(t,o){return this.http.put(`${u.URL}/product/approve/${t}/${o}`,{})}deleteProduct(t){return this.http.delete(`${u.URL}/product/${t}`)}deleteAllProduct(t){return this.http.post(`${u.URL}/product/deleteAll`,{ids:t})}replicateProduct(t){return this.http.post(`${u.URL}/product/replicate`,{ids:t})}importProduct(t){let o=new FormData;return Array.isArray(t)&&t.length&&t.forEach((p,i)=>{o.append("products",p,p.name)}),this.http.post(`${u.URL}/product/csv/import`,o)}exportProduct(t){let o={};return this.http.post(`${u.URL}/product/csv/export`,t,{responseType:"blob"})}download(t){return this.http.post(`${u.URL}/download/admin/zip/link`,t)}};e.\u0275fac=function(o){return new(o||e)(m(y))},e.\u0275prov=w({token:e,factory:e.\u0275fac,providedIn:"root"});let v=e;return v})();var n,a=(n=class{constructor(e,r,t){this.store=e,this.notificationService=r,this.productService=t}static product(e){return e.product}static products(e){return e.product.data.filter(r=>r.id!==e.selectedProduct?.id).map(r=>({label:r?.name,value:r?.id,data:{type:r.type,name:r.name,slug:r.slug,stock_status:r.stock_status,image:r.product_thumbnail?r.product_thumbnail.original_url:"assets/images/product.png"}}))}static digitalProducts(e){let r=[];return e.product.data.filter(t=>t.id!==e.selectedProduct?.id&&t.product_type=="digital").map(t=>{r.push({label:t?.name,value:t?.id,data:{name:t.name,product_id:t?.id,variation_id:null,image:t.product_thumbnail?t.product_thumbnail.original_url:"assets/images/product.png"}}),t?.variations?.length&&t.variations.map(o=>{r.push({label:o?.name,value:o?.id,data:{name:o.name,product_id:t?.id,variation_id:o?.id,image:o.variation_image?o.variation_image.original_url:"assets/images/product.png"}})})}),r}static selectedProduct(e){return e.selectedProduct}static topSellingProducts(e){return e.topSellingProducts}getProducts(e,r){return this.productService.getProducts(r.payload).pipe(d({next:t=>{if(r?.payload.top_selling){let o=e.getState();e.patchState(h(l({},o),{topSellingProducts:t.data}))}else e.patchState({product:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}create(e,r){return this.productService.createProduct(r.payload).pipe(d({next:t=>{let o=e.getState();e.patchState(h(l({},o),{product:{data:[...o.product.data,t],total:o?.product.total+1}}))},complete:()=>{this.notificationService.showSuccess("Product Created Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}edit(e,{id:r}){return this.productService.editProduct(r).pipe(d({next:t=>{let o=e.getState();e.patchState(h(l({},o),{selectedProduct:t}))},error:t=>{throw new Error(t?.error?.message)}}))}update(e,{payload:r,id:t}){return this.productService.updateProduct(t,r).pipe(d({next:o=>{if(typeof o=="object"){let p=e.getState(),i=[...p.product.data],f=i.findIndex(P=>P.id===t);i[f]=o,e.patchState(h(l({},p),{product:{data:i,total:p.product.total}}))}},complete:()=>{this.notificationService.showSuccess("Product Updated Successfully")},error:o=>{throw new Error(o?.error?.message)}}))}updateStatus(e,{id:r,status:t}){return this.productService.updateProductStatus(r,t).pipe(d({next:o=>{if(typeof o=="object"){let p=e.getState(),i=[...p.product.data],f=i.findIndex(P=>P.id===r);i[f]=o,e.patchState(h(l({},p),{product:{data:i,total:p.product.total}}))}},complete:()=>{this.notificationService.showSuccess("Product Status Updated Successfully")},error:o=>{throw new Error(o?.error?.message)}}))}approveStatus(e,{id:r,status:t}){return this.productService.approveProductStatus(r,t).pipe(d({next:o=>{if(typeof o=="object"){let p=e.getState(),i=[...p.product.data],f=i.findIndex(P=>P.id===r);i[f]=o,e.patchState(h(l({},p),{product:{data:i,total:p.product.total}})),this.store.dispatch(new $("/product",o?.total_in_approved_products))}},complete:()=>{this.notificationService.showSuccess("Product Status Updated Successfully")},error:o=>{throw new Error(o?.error?.message)}}))}delete(e,{id:r}){return this.productService.deleteProduct(r).pipe(d({next:()=>{this.store.dispatch(new g({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Product Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}deleteAll(e,{ids:r}){return this.productService.deleteAllProduct(r).pipe(d({next:()=>{this.store.dispatch(new g({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Product Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}replicateProduct(e,{ids:r}){return this.productService.replicateProduct(r).pipe(d({next:()=>{this.store.dispatch(new g({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Product Replicated Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}import(e,r){return this.productService.importProduct(r.payload).pipe(d({next:t=>{this.store.dispatch(new g({page:1,paginate:15}))},error:t=>{throw new Error(t?.error?.message)}}))}export(e,r){return this.productService.exportProduct(r.payload).pipe(d({next:t=>{let o=new Blob([t],{type:"text/csv"}),p=window.URL.createObjectURL(o),i=document.createElement("a");i.href=p,i.download="products.csv",i.click(),window.URL.revokeObjectURL(p)},error:t=>{throw new Error(t?.error?.message)}}))}download(e,r){return this.productService.download(r.payload).pipe(d({next:t=>{t&&t.download_link&&window.location.assign(t.download_link)},error:t=>{throw new Error(t?.error?.message)}}))}},n.\u0275fac=function(r){return new(r||n)(m(x),m(b),m(F))},n.\u0275prov=w({token:n,factory:n.\u0275fac}),n);c([s(g)],a.prototype,"getProducts",null);c([s(R)],a.prototype,"create",null);c([s(E)],a.prototype,"edit",null);c([s(L)],a.prototype,"update",null);c([s(_)],a.prototype,"updateStatus",null);c([s(j)],a.prototype,"approveStatus",null);c([s(k)],a.prototype,"delete",null);c([s(A)],a.prototype,"deleteAll",null);c([s(I)],a.prototype,"replicateProduct",null);c([s(D)],a.prototype,"import",null);c([s(B)],a.prototype,"export",null);c([s(C)],a.prototype,"download",null);c([S()],a,"product",null);c([S()],a,"products",null);c([S()],a,"digitalProducts",null);c([S()],a,"selectedProduct",null);c([S()],a,"topSellingProducts",null);a=c([U({name:"product",defaults:{product:{data:[],total:0},selectedProduct:null,topSellingProducts:[]}})],a);export{a};
