import{a as I,b as we,c as xe,d as M}from"./chunk-ET3EDJNC.js";import{a as N}from"./chunk-EH2XKO42.js";import"./chunk-X62LHEF6.js";import{a as ye}from"./chunk-YK6OOJHV.js";import{$a as ce,A as te,B as ie,Dc as ge,E as G,Ea as se,Ec as Ce,G as oe,H as re,K as ne,N as ae,Oa as pe,Ob as be,S as le,Ua as me,ab as fe,fb as ue,k as Y,l as Z,lb as ve,o as y,pb as he,qb as _e,y as ee,z as k}from"./chunk-AYDE6MWJ.js";import{Ea as o,Fa as _,Hb as j,Ka as R,Nb as l,Ob as s,Oc as P,Qa as B,Rc as de,Sa as a,Wa as T,aa as x,ab as d,ac as z,bb as m,cb as V,db as Q,eb as U,ga as A,gb as D,ha as S,hc as J,jb as b,jc as K,kb as g,mc as L,n as u,nb as F,oa as v,pa as h,rb as q,sb as O,tb as H,tc as X,ub as W,vb as C,wb as E,xb as $}from"./chunk-RFGELG3T.js";var Ne=["confirmationModal"],Ie=()=>["vendor_wallet.credit","vendor_wallet.debit"],Me=()=>[];function Be(n,e){if(n&1&&(d(0,"div",14)(1,"form",5)(2,"app-page-wrapper",6),V(3,"select2",15),l(4,"translate"),l(5,"async"),l(6,"async"),l(7,"translate"),m()()()),n&2){let i,t=g();o(),a("formGroup",t.form),o(),a("gridClass","col-sm-12")("title","select_vendor"),o(),F("noResultMessage",s(4,6,"no_data_found")),a("data",(i=s(5,8,t.users$))!=null&&i.length?s(6,10,t.users$):j(14,Me))("placeholder",s(7,12,"select_vendor"))}}function Te(n,e){if(n&1){let i=D();Q(0),V(1,"input",16,1),l(3,"translate"),d(4,"div",17)(5,"app-button",18),b("click",function(){v(i);let r=g();return h(r.form.valid&&r.ConfirmationModal.openModal("credit"))}),C(6),l(7,"translate"),m(),d(8,"app-button",19),b("click",function(){v(i);let r=W(2),p=g();return h(+p.balance<+r.value||!!r.value&&p.ConfirmationModal.openModal("debit"))}),C(9),l(10,"translate"),m()(),U()}if(n&2){let i=W(2),t=g();o(),F("placeholder",s(3,11,"add_withdraw_amount")),o(4),T("btn btn-animation"),a("disabled",!t.form.valid)("spinner",!1),o(),$(" ",s(7,13,"add")," "),o(2),T("btn btn-outline"),a("spinner",!1)("disabled",+t.balance<+i.value||!i.value),o(),$(" ",s(10,15,"withdraw")," ")}}var f=class f{constructor(e,i,t,r){this.document=e,this.renderer=i,this.store=t,this.formBuilder=r,this.balance=0,this.tableConfig={columns:[{title:"amount",dataField:"amount",type:"price"},{title:"type",dataField:"type_status"},{title:"remark",dataField:"detail"},{title:"created_at",dataField:"created_at",type:"date"}],data:[],total:0},this.store.selectSnapshot(p=>p.account.roleName!=="vendor")&&this.store.dispatch(new be({role:"vendor",status:1})),this.form=this.formBuilder.group({vendor_id:new G("",[k.required]),balance:new G("",[k.required])}),this.store.selectSnapshot(p=>p.account.roleName!=="vendor")?this.form.controls.vendor_id.valueChanges.subscribe(p=>{p&&(this.paginateInitialData.vendor_id=p,this.store.dispatch(new I(this.paginateInitialData)),this.transactions())}):(this.store.dispatch(new I),this.transactions())}transactions(){this.vendorWallet$.subscribe(e=>{let i=e?.transactions?.data?.filter(t=>(t.type_status=t.type?`<div class="status-${t.type}"><span>${t.type.replace(/_/g," ")}</span></div>`:"-",t));this.balance=e?e?.balance:0,this.tableConfig.data=e?i:[],this.tableConfig.total=e?e?.transactions?.total:0}),this.renderer.addClass(this.document.body,"loader-none")}onTableChange(e){this.paginateInitialData=e;let i=this.form.controls.vendor_id?.value;this.paginateInitialData.vendor_id=i,i&&this.store.dispatch(new I(this.paginateInitialData))}submit(e){this.form.markAllAsTouched();let i=new we(this.form.value);e=="debit"&&(i=new xe(this.form.value)),this.form.valid&&this.store.dispatch(i).subscribe({complete:()=>{this.form.controls.balance.reset()}})}ngOnDestroy(){this.renderer.removeClass(this.document.body,"loader-none")}};f.\u0275fac=function(i){return new(i||f)(_(z),_(R),_(Y),_(le))},f.\u0275cmp=A({type:f,selectors:[["app-vendor-wallet"]],viewQuery:function(i,t){if(i&1&&q(Ne,5),i&2){let r;O(r=H())&&(t.ConfirmationModal=r.first)}},decls:23,vars:21,consts:[["confirmationModal",""],["bal",""],[1,"row","g-0"],["class","col-xxl-4 col-xl-5",4,"ngIf"],[3,"ngClass"],[3,"formGroup"],[3,"gridClass","title"],[1,"wallet-sec","theme-form"],[1,"wallet-amount"],[1,"wallet-icon"],[1,"ri-wallet-line"],[4,"hasPermission"],[3,"tableChanged","dateRange","tableConfig"],[3,"confirmed"],[1,"col-xxl-4","col-xl-5"],["formControlName","vendor_id",1,"custom-select",3,"data","placeholder","noResultMessage"],["type","number","formControlName","balance","numbersOnly","",1,"form-control",3,"placeholder"],[1,"btn-sec"],[3,"click","disabled","spinner"],[3,"click","spinner","disabled"]],template:function(i,t){if(i&1){let r=D();d(0,"div",2),B(1,Be,8,15,"div",3),l(2,"async"),d(3,"div",4),l(4,"async"),d(5,"form",5)(6,"app-page-wrapper",6)(7,"div",7)(8,"div",8)(9,"div",9),V(10,"i",10),m(),d(11,"div")(12,"h2"),C(13),l(14,"currencySymbol"),m(),d(15,"h5"),C(16),l(17,"translate"),m()()(),B(18,Te,11,17,"ng-container",11),m()()()()(),d(19,"app-page-wrapper",6)(20,"app-table",12),b("tableChanged",function(w){return v(r),h(t.onTableChange(w))}),m()(),d(21,"app-confirmation-modal",13,0),b("confirmed",function(w){return v(r),h(t.submit(w==null?null:w.actionToPerform))}),m()}i&2&&(o(),a("ngIf",s(2,12,t.roleName$)!=="vendor"),o(2),a("ngClass",s(4,14,t.roleName$)!=="vendor"?"col-xxl-8 col-xl-7":"col-xxl-12 col-xl-12"),o(2),a("formGroup",t.form),o(),a("gridClass","col-sm-12")("title","wallet"),o(7),E(s(14,16,t.balance)),o(3),E(s(17,18,"wallet_balance")),o(2),a("hasPermission",j(20,Ie)),o(),a("gridClass","col-sm-12")("title","transactions"),o(),a("dateRange",!0)("tableConfig",t.tableConfig))},dependencies:[J,K,oe,ee,re,te,ie,ne,ae,ue,_e,ve,me,ce,ge,fe,L,de,he]});var c=f;u([y(N.users)],c.prototype,"users$",void 0);u([y(pe.setting)],c.prototype,"setting$",void 0);u([y(M.vendorWallet)],c.prototype,"vendorWallet$",void 0);u([y(se.getRoleName)],c.prototype,"roleName$",void 0);var De=[{path:"",component:c,canActivate:[ye],data:{permission:"vendor_wallet.index"}}],Ve=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=S({type:e}),e.\u0275inj=x({imports:[P.forChild(De),P]});let n=e;return n})();var ft=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=S({type:e}),e.\u0275inj=x({imports:[X,Ve,Ce,Z.forFeature([N,M])]});let n=e;return n})();export{ft as VendorWalletModule};
