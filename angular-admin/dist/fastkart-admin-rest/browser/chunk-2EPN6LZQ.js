import{a as Se,b as Ie,c as Fe,d as Te}from"./chunk-YJBHC5EX.js";import{a as R,b as be,c as xe,e as we,g as Ne,h as C}from"./chunk-6ZNSPRFI.js";import{a as A}from"./chunk-YK6OOJHV.js";import{A as se,B as ce,E as D,Ea as ue,Ec as Ce,G as le,K as me,N as de,S as fe,Ua as _e,ab as he,fb as ge,k as B,l as ae,lb as y,o as L,qb as ve,rb as ye,y as pe,z as k}from"./chunk-AYDE6MWJ.js";import{Ba as K,Ea as r,Fa as _,Hb as w,Jc as re,Lc as P,Mc as ne,Nb as m,Ob as d,Oc as G,Qa as f,Rc as q,S as z,Sa as n,T as J,Ua as Q,aa as S,ab as s,bb as c,cb as l,db as X,eb as Y,ga as u,gb as Z,ha as I,i as O,ic as te,jb as E,jc as M,kb as h,mc as ie,n as j,nb as V,oa as F,p as U,pa as T,tc as oe,u as W,vb as g,wb as ee,xb as v}from"./chunk-RFGELG3T.js";var je=()=>["notice.create","notice.destroy","notice.index"],Ve=()=>["/notice/create"];function Ge(t,e){t&1&&(s(0,"div",5)(1,"a",6),l(2,"i",7),g(3),m(4,"translate"),c()()),t&2&&(r(),n("routerLink",w(4,Ve)),r(2),v(" ",d(4,2,"add_notice")," "))}function Le(t,e){if(t&1){let o=Z();s(0,"app-page-wrapper",2),f(1,Ge,5,5,"div",3),s(2,"app-table",4),E("tableChanged",function(a){F(o);let p=h();return T(p.onTableChange(a))})("rowClicked",function(a){F(o);let p=h();return T(p.edit(a))})("action",function(a){F(o);let p=h();return T(p.onActionClicked(a))}),c()()}if(t&2){let o=h();n("gridClass","col-sm-12")("title","notices"),r(),n("hasPermission","notice.create"),r(),n("tableConfig",o.tableConfig)("hasCheckbox",!1)}}function Re(t,e){if(t&1&&(s(0,"li",12)(1,"div",13)(2,"div",14),l(3,"i",15),c(),s(4,"div",16)(5,"h3"),g(6),c(),l(7,"p",17),c()()()),t&2){let o=e.$implicit;Q("warning",o.priority==="low"),r(6),ee(o==null?null:o.title),r(),n("innerHTML",o==null?null:o.description,K)}}function He(t,e){if(t&1&&(s(0,"ul",10),f(1,Re,8,4,"li",11),m(2,"async"),c()),t&2){let o,i=h(3);r(),n("ngForOf",(o=d(2,1,i.notice$))==null?null:o.data)}}function Oe(t,e){if(t&1&&(s(0,"app-page-wrapper",2),f(1,He,3,3,"ul",9),m(2,"async"),c()),t&2){let o,i=h(2);n("gridClass","col-xxl-8 m-auto")("title","Notice"),r(),n("ngIf",(o=d(2,3,i.notice$))==null||o.data==null?null:o.data.length)}}function Ue(t,e){if(t&1&&(X(0),f(1,Oe,3,5,"app-page-wrapper",8),Y()),t&2){let o=h();r(),n("ngIf",!o.hasPermission("notice.create")&&!o.hasPermission("notice.destroy"))}}var b=class b{constructor(e,o){this.store=e,this.router=o,this.permissions=[],this.tableConfig={columns:[{title:"title",dataField:"title",sortable:!0,sort_direction:"desc"},{title:"priority",dataField:"badge"},{title:"created_at",dataField:"created_at",type:"date",sortable:!0,sort_direction:"desc"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"notice.edit"},{label:"Delete",actionToPerform:"delete",icon:"ri-delete-bin-line",permission:"notice.destroy"}],data:[],total:0}}ngOnInit(){this.role=this.store.selectSnapshot(e=>e.account&&e.account.roleName),this.role!=="admin"&&this.store.dispatch(new R),this.notice$.subscribe(e=>{let o=e?.data?.filter(i=>(i.badge=i.priority?`<div class="status-${i.priority}"><span>${i.priority}</span></div>`:"-",i));this.tableConfig.data=e?o:[],this.tableConfig.total=e?e?.total:0})}hasPermission(e){return this.permissions$.subscribe(o=>this.permissions=o?.map(i=>i?.name)),this.permissions.includes(e)}onTableChange(e){this.store.dispatch(new R(e))}onActionClicked(e){e.actionToPerform=="edit"?this.edit(e.data):e.actionToPerform=="delete"&&this.delete(e.data)}edit(e){this.router.navigateByUrl(`/notice/edit/${e.id}`)}delete(e){this.store.dispatch(new Ne(e.id))}};b.\u0275fac=function(o){return new(o||b)(_(B),_(P))},b.\u0275cmp=u({type:b,selectors:[["app-notice"]],decls:2,vars:3,consts:[[3,"gridClass","title",4,"hasPermission"],[4,"ngIf"],[3,"gridClass","title"],["class","d-flex flex-wrap gap-2","button","",4,"hasPermission"],[3,"tableChanged","rowClicked","action","tableConfig","hasCheckbox"],["button","",1,"d-flex","flex-wrap","gap-2"],[1,"align-items-center","btn","btn-theme",3,"routerLink"],[1,"ri-add-line"],[3,"gridClass","title",4,"ngIf"],["class","notification-setting notification-page",4,"ngIf"],[1,"notification-setting","notification-page"],["class","notice-section",3,"warning",4,"ngFor","ngForOf"],[1,"notice-section"],[1,"notice-content"],[1,"icon-box"],[1,"ri-error-warning-line"],[1,"notice-box"],[3,"innerHTML"]],template:function(o,i){o&1&&f(0,Le,3,5,"app-page-wrapper",0)(1,Ue,2,1,"ng-container",1),o&2&&(n("hasPermission",w(2,je)),r(),n("ngIf",i.role!=="admin"))},dependencies:[te,M,ne,ve,y,he,ie,q]});var x=b;j([L(C.notice)],x.prototype,"notice$",void 0);j([L(ue.permissions)],x.prototype,"permissions$",void 0);var We=()=>[];function ze(t,e){t&1&&(s(0,"div",10),g(1),m(2,"translate"),c()),t&2&&(r(),v(" ",d(2,1,"title_is_required")," "))}function Je(t,e){t&1&&(s(0,"div",10),g(1),m(2,"translate"),c()),t&2&&(r(),v(" ",d(2,1,"description_is_required")," "))}function Ke(t,e){t&1&&(s(0,"div",10),g(1),m(2,"translate"),c()),t&2&&(r(),v(" ",d(2,1,"priority_select_is_required")," "))}var $=(()=>{let e=class e{constructor(i,a,p,H){this.store=i,this.router=a,this.route=p,this.formBuilder=H,this.priority=[{label:"High",value:"high"},{label:"Low",value:"low"}],this.destroy$=new O,this.form=this.formBuilder.group({title:new D("",[k.required]),description:new D("",[k.required]),priority:new D("",[k.required])})}ngOnInit(){this.route.params.pipe(z(i=>i.id?this.store.dispatch(new xe(i.id)).pipe(W(()=>this.store.select(C.selectedNotice))):U()),J(this.destroy$)).subscribe(i=>{this.notice=i,this.form.patchValue({title:this.notice?.title,description:this.notice?.description,priority:this.notice?.priority})}),this.editor=new Te}submit(){this.form.markAllAsTouched();let i=new be(this.form.value);this.type=="edit"&&this.notice?.id&&(i=new we(this.form.value,this.notice.id)),this.form.valid&&this.store.dispatch(i).subscribe({complete:()=>{this.router.navigateByUrl("/notice")}})}};e.\u0275fac=function(a){return new(a||e)(_(B),_(P),_(re),_(fe))},e.\u0275cmp=u({type:e,selectors:[["app-form-notice"]],inputs:{type:"type"},decls:18,vars:30,consts:[[1,"theme-form","theme-form-2","mega-form",3,"ngSubmit","formGroup"],[3,"label","for","required"],["type","text","name","title","formControlName","title",1,"form-control",3,"placeholder"],["class","invalid-feedback",4,"ngIf"],[1,"custom-editor"],[3,"editor"],["formControlName","description",3,"editor","placeholder"],[3,"label","for"],["formControlName","priority","resettable","","multiple","false",1,"custom-select",3,"data","placeholder","noResultMessage"],[3,"id"],[1,"invalid-feedback"]],template:function(a,p){a&1&&(s(0,"form",0),E("ngSubmit",function(){return p.submit()}),s(1,"app-form-fields",1),l(2,"input",2),m(3,"translate"),f(4,ze,3,3,"div",3),c(),s(5,"app-form-fields",1)(6,"div",4),l(7,"ngx-editor-menu",5)(8,"ngx-editor",6),c(),f(9,Je,3,3,"div",3),c(),s(10,"app-form-fields",7),l(11,"select2",8),m(12,"translate"),m(13,"translate"),f(14,Ke,3,3,"div",3),c(),s(15,"app-button",9),g(16),m(17,"translate"),c()()),a&2&&(n("formGroup",p.form),r(),n("label","title")("for","title")("required",!0),r(),V("placeholder",d(3,21,"enter_title")),r(2),n("ngIf",p.form.controls.title.touched&&(p.form.controls.title.errors==null?null:p.form.controls.title.errors.required)),r(),n("label","description")("for","description")("required",!0),r(2),n("editor",p.editor),r(),n("editor",p.editor)("placeholder","Type here..."),r(),n("ngIf",p.form.controls.description.touched&&(p.form.controls.description.errors==null?null:p.form.controls.description.errors.required)),r(),n("label","priority")("for","priority"),r(),V("noResultMessage",d(12,23,"no_data_found")),n("data",p.priority.length?p.priority:w(29,We))("placeholder",d(13,25,"select_notice")),r(3),n("ngIf",p.form.controls.priority.touched&&(p.form.controls.priority.errors==null?null:p.form.controls.priority.errors.required)),r(),n("id","notice_btn"),r(),v(" ",d(17,27,p.type=="create"?"save_notice":"update_notice")," "))},dependencies:[M,le,pe,se,ce,me,de,ge,ye,_e,Se,Ie,q]});let t=e;return t})();var Pe=(()=>{let e=class e{};e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=u({type:e,selectors:[["app-create-notice"]],decls:2,vars:2,consts:[[3,"title"],[3,"type"]],template:function(a,p){a&1&&(s(0,"app-page-wrapper",0),l(1,"app-form-notice",1),c()),a&2&&(n("title","create_notice"),r(),n("type","create"))},dependencies:[y,$]});let t=e;return t})();var Be=(()=>{let e=class e{};e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=u({type:e,selectors:[["app-edit-notice"]],decls:2,vars:2,consts:[[3,"title"],[3,"type"]],template:function(a,p){a&1&&(s(0,"app-page-wrapper",0),l(1,"app-form-notice",1),c()),a&2&&(n("title","edit_notice"),r(),n("type","edit"))},dependencies:[y,$]});let t=e;return t})();var Qe=[{path:"",component:x,canActivate:[A],data:{permission:"notice.index"}},{path:"create",component:Pe,canActivate:[A],data:{permission:["notice.index","notice.create"]}},{path:"edit/:id",component:Be,canActivate:[A],data:{permission:["notice.index","notice.edit"]}}],ke=(()=>{let e=class e{};e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=I({type:e}),e.\u0275inj=S({imports:[G.forChild(Qe),G]});let t=e;return t})();var $t=(()=>{let e=class e{};e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=I({type:e}),e.\u0275inj=S({imports:[oe,ke,Ce,Fe,ae.forFeature([C])]});let t=e;return t})();export{$t as NoticeModule};
