import{Ac as V,Da as U,a as p,k as y,m as c,n as x,p as m,rc as A,sc as $,tc as E,uc as L,vc as R,wc as j,xc as I,yc as k,zc as D}from"./chunk-AYDE6MWJ.js";import{$ as f,V as n,a as b,b as d,ca as h,n as o,xc as g}from"./chunk-RFGELG3T.js";var C=(()=>{let e=class e{constructor(t){this.http=t}getAttributes(t){return this.http.get(`${p.URL}/attribute`,{params:t})}getAttributeValues(t){return this.http.get(`${p.URL}/attribute-value`,{params:t})}createAttribute(t){return this.http.post(`${p.URL}/attribute`,t)}editAttribute(t){return this.http.get(`${p.URL}/attribute/${t}`)}updateAttribute(t,r){return this.http.put(`${p.URL}/attribute/${t}`,r)}updateAttributeStatus(t,r){return this.http.put(`${p.URL}/attribute/${t}/${r}`,{})}deleteAttribute(t){return this.http.delete(`${p.URL}/attribute/${t}`)}deleteAllAttribute(t){return this.http.post(`${p.URL}/attribute/deleteAll`,{ids:t})}importAttribute(t){let r=new FormData;return Array.isArray(t)&&t.length&&t.forEach((a,s)=>{r.append("attributes",a,a.name)}),this.http.post(`${p.URL}/attribute/csv/import`,r)}exportAttribute(){let t={};return this.http.post(`${p.URL}/attribute/csv/export`,t,{responseType:"blob"})}};e.\u0275fac=function(r){return new(r||e)(h(g))},e.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"});let S=e;return S})();var l,u=(l=class{constructor(e,i,t){this.store=e,this.notificationService=i,this.attributeService=t}static attribute(e){return e.attribute}static attributes(e){return i=>{let t=Array.from(new Set(i.split(","))).map(Number);return(t.length?e.attribute.data.filter(a=>!t.includes(Number(a.id))):e.attribute.data).map(a=>({label:a?.name,value:a?.id,attribute_values:a?.attribute_values}))}}static attribute_value(e){return i=>i?e?.attribute_values.filter(t=>+t.attribute_id===i)?.map(t=>({label:t?.value,value:t?.id})):[]}static selectedAttribute(e){return e.selectedAttribute}getAttributes(e,i){return this.attributeService.getAttributes(i.payload).pipe(n({next:t=>{e.patchState({attribute:{data:t.data,total:t?.total?t?.total:t.data.length}})},error:t=>{throw new Error(t?.error?.message)}}))}getAttributeValues(e,i){return this.attributeService.getAttributeValues(i.payload).pipe(n({next:t=>{let r=e.getState();e.patchState(d(b({},r),{attribute_values:t.data}))},error:t=>{throw new Error(t?.error?.message)}}))}create(e,i){return this.attributeService.createAttribute(i.payload).pipe(n({next:t=>{let r=e.getState();e.patchState(d(b({},r),{attribute:{data:[...r.attribute.data,t],total:r?.attribute.total+1}}))},complete:()=>{this.notificationService.showSuccess("Attribute Created Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}edit(e,{id:i}){return this.attributeService.editAttribute(i).pipe(n({next:t=>{let r=e.getState();e.patchState(d(b({},r),{selectedAttribute:t}))},error:t=>{throw new Error(t?.error?.message)}}))}update(e,{payload:i,id:t}){return this.attributeService.updateAttribute(t,i).pipe(n({next:r=>{if(typeof r=="object"){let a=e.getState(),s=[...a.attribute.data],w=s.findIndex(v=>v.id===t);s[w]=r,e.patchState(d(b({},a),{attribute:{data:s,total:a.attribute.total}}))}},complete:()=>{this.notificationService.showSuccess("Attribute Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}updateStatus(e,{id:i,status:t}){return this.attributeService.updateAttributeStatus(i,t).pipe(n({next:r=>{if(typeof r=="object"){let a=e.getState(),s=[...a.attribute.data],w=s.findIndex(v=>v.id===i);s[w]=r,e.patchState(d(b({},a),{attribute:{data:s,total:a.attribute.total}}))}},complete:()=>{this.notificationService.showSuccess("Attribute Status Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}delete(e,{id:i}){return this.attributeService.deleteAttribute(i).pipe(n({next:()=>{this.store.dispatch(new A({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Attribute Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}deleteAll(e,{ids:i}){return this.attributeService.deleteAllAttribute(i).pipe(n({next:()=>{this.store.dispatch(new A({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Attribute Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}import(e,i){return this.attributeService.importAttribute(i.payload).pipe(n({next:t=>{this.store.dispatch(new A({page:1,paginate:15}))},error:t=>{throw new Error(t?.error?.message)}}))}export(e,i){return this.attributeService.exportAttribute().pipe(n({next:t=>{let r=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download="attributes.csv",s.click(),window.URL.revokeObjectURL(a)},error:t=>{throw new Error(t?.error?.message)}}))}},l.\u0275fac=function(i){return new(i||l)(h(y),h(U),h(C))},l.\u0275prov=f({token:l,factory:l.\u0275fac}),l);o([c(A)],u.prototype,"getAttributes",null);o([c($)],u.prototype,"getAttributeValues",null);o([c(E)],u.prototype,"create",null);o([c(L)],u.prototype,"edit",null);o([c(R)],u.prototype,"update",null);o([c(j)],u.prototype,"updateStatus",null);o([c(I)],u.prototype,"delete",null);o([c(k)],u.prototype,"deleteAll",null);o([c(D)],u.prototype,"import",null);o([c(V)],u.prototype,"export",null);o([m()],u,"attribute",null);o([m()],u,"attributes",null);o([m()],u,"attribute_value",null);o([m()],u,"selectedAttribute",null);u=o([x({name:"attribute",defaults:{attribute:{data:[],total:0},attribute_values:[],selectedAttribute:null}})],u);export{u as a};
