import{a as ke,b as Pe,c as Se,d as we,e as Ie,f as Fe,g as Ee,h as y}from"./chunk-6FSDMVQO.js";import{a as j}from"./chunk-YK6OOJHV.js";import{A as de,B as fe,E as J,Ec as xe,G as ue,K as he,N as Ce,S as ge,Ua as _e,ab as ve,k as b,l as le,lb as x,o as N,qb as ye,rb as be,y as ce,z}from"./chunk-AYDE6MWJ.js";import{Ea as s,Fa as u,Hb as ie,Jc as me,Lc as D,Mc as pe,Nb as c,Ob as d,Oc as H,Qa as g,Rc as $,S as Y,Sa as m,T as Z,aa as A,ab as a,bb as p,cb as _,db as G,eb as U,ga as f,gb as L,ha as M,i as K,ic as oe,jb as v,jc as re,kb as w,mc as ne,n as T,na as ee,nb as I,nc as se,oa as O,ob as W,p as Q,pa as q,tc as ae,u as X,vb as l,wb as B,xa as te,xb as h}from"./chunk-RFGELG3T.js";var je=()=>["/role/create"];function Ve(r,e){r&1&&(a(0,"div",3)(1,"a",4),_(2,"i",5),l(3),c(4,"translate"),p()()),r&2&&(s(),m("routerLink",ie(4,je)),s(2),h(" ",d(4,2,"add_role")," "))}var k=class k{constructor(e,i){this.store=e,this.router=i,this.tableConfig={columns:[{title:"name",dataField:"name",sortable:!0,sort_direction:"desc"},{title:"created_at",dataField:"created_at",type:"date",sortable:!0,sort_direction:"desc"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"role.edit"},{label:"Delete",actionToPerform:"delete",icon:"ri-delete-bin-line",permission:"role.destroy"}],data:[],total:0}}ngOnInit(){this.role$.subscribe(e=>{this.tableConfig.data=e?e?.data:[],this.tableConfig.total=e?e?.total:0})}onTableChange(e){this.store.dispatch(new ke(e))}onActionClicked(e){e.actionToPerform=="edit"?this.edit(e.data):e.actionToPerform=="delete"?this.delete(e.data):e.actionToPerform=="deleteAll"&&this.deleteAll(e.data)}edit(e){this.router.navigateByUrl(`/role/edit/${e.id}`)}delete(e){this.store.dispatch(new Fe(e.id))}deleteAll(e){this.store.dispatch(new Ee(e))}};k.\u0275fac=function(i){return new(i||k)(u(b),u(D))},k.\u0275cmp=f({type:k,selectors:[["app-role"]],decls:3,vars:5,consts:[[3,"gridClass","title"],["button","",4,"hasPermission"],[3,"tableChanged","rowClicked","action","tableConfig","hasCheckbox"],["button",""],[1,"align-items-center","btn","btn-theme","d-flex",3,"routerLink"],[1,"ri-add-line"]],template:function(i,t){i&1&&(a(0,"app-page-wrapper",0),g(1,Ve,5,5,"div",1),a(2,"app-table",2),v("tableChanged",function(n){return t.onTableChange(n)})("rowClicked",function(n){return t.edit(n)})("action",function(n){return t.onActionClicked(n)}),p()()),i&2&&(m("gridClass","col-sm-12")("title","roles"),s(),m("hasPermission","role.create"),s(),m("tableConfig",t.tableConfig)("hasCheckbox",!0))},dependencies:[pe,ye,x,ve,$]});var F=k;T([N(y.role)],F.prototype,"role$",void 0);function qe(r,e){if(r&1){let i=L();G(0),a(1,"li")(2,"div",5)(3,"input",8),v("change",function(o){let n=O(i).$implicit,C=w().$implicit,R=w();return q(n.name==="index"&&n.isChecked?R.checkIndex(o,C):R.onPermissionChecked(o,C))}),p(),a(4,"label",7),l(5),c(6,"titlecase"),p()()(),U()}if(r&2){let i=e.$implicit,t=w(2);s(3),I("id",i.permission_id),m("name",i.name)("checked",!!(t.selectedPermission!=null&&t.selectedPermission.includes(+i.permission_id)||i.isChecked))("value",i.permission_id),s(),I("for",i.permission_id),s(),h(" ",d(6,6,i.name)," ")}}function Ge(r,e){if(r&1){let i=L();G(0),a(1,"div",4)(2,"ul")(3,"li"),l(4),c(5,"titlecase"),p(),a(6,"li")(7,"div",5)(8,"input",6),v("change",function(o){let n=O(i).$implicit,C=w();return q(C.checkUncheckAll(o,n))}),p(),a(9,"label",7),l(10),p()()(),g(11,qe,7,8,"ng-container",3),p()(),U()}if(r&2){let i=e.$implicit;s(4),h("",d(5,8,i==null?null:i.name.replace("_"," "))," "),s(4),W("id","role-",i.id,""),m("checked",i.isChecked),s(),W("for","role-",i.id,""),s(),B("all"),s(),m("ngForOf",i.module_permissions)}}var S=class S{constructor(e){this.store=e,this.selectedPermission=[],this.setPermissions=new te,this.store.dispatch(new Pe)}ngOnChanges(e){let i=e.selectedPermission?.currentValue;this.modules$.subscribe(t=>{t?.map(o=>{o.module_permissions.map(n=>{n.isChecked=i.includes(n.id)})}),t?.filter(o=>{this.updateCheckBoxStatus(o)})})}checkUncheckAll(e,i){i.module_permissions.forEach(t=>{t.isChecked=e.target.checked,this.addPermission(e.target.checked,t?.id,i)})}checkIndex(e,i){i.module_permissions.forEach(t=>{t.isChecked=!1,this.addPermission(!1,t?.id,i)})}onPermissionChecked(e,i){i.module_permissions.forEach(t=>{t.isChecked=!1,t.name=="index"&&(t.isChecked=!t.isChecked,this.addPermission(!0,+t.id,i)),this.addPermission(e.target?.checked,+e?.target?.value,i)})}addPermission(e,i,t){let o=this.selectedPermission.indexOf(Number(i));e?o==-1&&this.selectedPermission.push(Number(i)):this.selectedPermission=this.selectedPermission.filter(n=>n!=Number(i)),this.setPermissions.emit(this.selectedPermission),this.updateCheckBoxStatus(t)}updateCheckBoxStatus(e){let i=0;e.module_permissions.filter(t=>{this.selectedPermission.includes(t.id)&&i++,e.module_permissions.length<=i?e.isChecked=!0:e.isChecked=!1})}};S.\u0275fac=function(i){return new(i||S)(u(b))},S.\u0275cmp=f({type:S,selectors:[["app-permissions"]],inputs:{selectedPermission:"selectedPermission"},outputs:{setPermissions:"setPermissions"},features:[ee],decls:5,vars:3,consts:[[1,"row","g-sm-4","g-2"],[1,"col-xl-12"],[1,"row","roles-form"],[4,"ngFor","ngForOf"],[1,"col-12"],[1,"form-check","form-switch"],["type","checkbox",1,"checkbox_animated","form-check-input","checkall",3,"change","id","checked"],[1,"form-check-label","m-0","form-label",3,"for"],["type","checkbox",1,"checkbox_animated","form-check-input","check-it",3,"change","name","id","checked","value"]],template:function(i,t){i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),g(3,Ge,12,10,"ng-container",3),c(4,"async"),p()()()),i&2&&(s(3),m("ngForOf",d(4,1,t.modules$)))},dependencies:[oe,ne,se]});var E=S;T([N(y.roleModules)],E.prototype,"modules$",void 0);function Le(r,e){r&1&&(a(0,"div",11),l(1),c(2,"translate"),p()),r&2&&(s(),h(" ",d(2,1,"name_is_required")," "))}function We(r,e){r&1&&(a(0,"div",12),l(1),c(2,"translate"),p()),r&2&&(s(),h(" ",d(2,1,"permissions_is_required")," "))}var V=(()=>{let e=class e{constructor(t,o,n,C){this.store=t,this.route=o,this.router=n,this.formBuilder=C,this.permissions=[],this.destroy$=new K,this.form=this.formBuilder.group({name:new J("",[z.required]),permissions:new J("",[z.required])})}get permissionControl(){return this.form.get("permissions")}ngOnInit(){this.route.params.pipe(Y(t=>t.id?this.store.dispatch(new we(t.id)).pipe(X(()=>this.store.select(y.selectedRole))):Q()),Z(this.destroy$)).subscribe(t=>{this.id=t?.id;let o=t?.permissions.map(n=>n?.id);this.permissions=o,this.form.patchValue({name:t?.name,permissions:o})})}setPermissions(t){Array.isArray(t)&&this.form.controls.permissions.setValue(t)}submit(){this.form.markAllAsTouched();let t=new Se(this.form.value);this.type=="edit"&&this.id&&(t=new Ie(this.form.value,this.id)),this.form.valid&&this.store.dispatch(t).subscribe({complete:()=>{this.router.navigateByUrl("/role")}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(o){return new(o||e)(u(b),u(me),u(D),u(ge))},e.\u0275cmp=f({type:e,selectors:[["app-form-role"]],inputs:{type:"type"},decls:17,vars:17,consts:[[1,"theme-form","theme-form-2","mega-form",3,"ngSubmit","formGroup"],[1,"row"],[3,"label","for","required"],["type","text","name","name","formControlName","name",1,"form-control",3,"placeholder"],["class","invalid-feedback",4,"ngIf"],[1,"mb-3","d-flex"],[1,"form-label-title"],[1,"theme-color","ms-2","required-dot"],["class","mt-0 ms-4 invalid-feedback",4,"ngIf"],[3,"setPermissions","selectedPermission"],[3,"id"],[1,"invalid-feedback"],[1,"mt-0","ms-4","invalid-feedback"]],template:function(o,n){o&1&&(a(0,"form",0),v("ngSubmit",function(){return n.submit()}),a(1,"div",1)(2,"app-form-fields",2),_(3,"input",3),c(4,"translate"),g(5,Le,3,3,"div",4),p(),a(6,"div",5)(7,"h4",6),l(8),c(9,"translate"),a(10,"span",7),l(11,"*"),p()(),g(12,We,3,3,"div",8),p(),a(13,"app-permissions",9),v("setPermissions",function(R){return n.setPermissions(R)}),p()(),a(14,"app-button",10),l(15),c(16,"translate"),p()()),o&2&&(m("formGroup",n.form),s(2),m("label","name")("for","name")("required",!0),s(),I("placeholder",d(4,11,"enter_name")),s(2),m("ngIf",n.form.controls.name.touched&&(n.form.controls.name.errors==null?null:n.form.controls.name.errors.required)),s(3),h("",d(9,13,"permissions")," "),s(4),m("ngIf",n.form.controls.permissions.touched&&n.form.controls.permissions.invalid),s(),m("selectedPermission",n.permissions),s(),m("id","role_btn"),s(),B(d(16,15,"save")))},dependencies:[re,ue,ce,de,fe,he,Ce,be,_e,E,$]});let r=e;return r})();var Me=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=f({type:e,selectors:[["app-create-role"]],decls:2,vars:3,consts:[[3,"gridClass","title"],[3,"type"]],template:function(o,n){o&1&&(a(0,"app-page-wrapper",0),_(1,"app-form-role",1),p()),o&2&&(m("gridClass","col-xxl-8 col-lg-10 m-auto")("title","create_role"),s(),m("type","create"))},dependencies:[x,V]});let r=e;return r})();var Be=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=f({type:e,selectors:[["app-edit-role"]],decls:2,vars:3,consts:[[3,"gridClass","title"],[3,"type"]],template:function(o,n){o&1&&(a(0,"app-page-wrapper",0),_(1,"app-form-role",1),p()),o&2&&(m("gridClass","col-xxl-8 col-lg-10 m-auto")("title","edit_role"),s(),m("type","edit"))},dependencies:[x,V]});let r=e;return r})();var He=[{path:"",component:F,canActivate:[j],data:{permission:"role.index"}},{path:"create",component:Me,canActivate:[j],data:{permission:["role.index","role.create"]}},{path:"edit/:id",component:Be,canActivate:[j],data:{permission:["role.index","role.edit"]}}],De=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=M({type:e}),e.\u0275inj=A({imports:[H.forChild(He),H]});let r=e;return r})();var Vt=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=M({type:e}),e.\u0275inj=A({imports:[ae,De,xe,le.forFeature([y])]});let r=e;return r})();export{Vt as RoleModule};
