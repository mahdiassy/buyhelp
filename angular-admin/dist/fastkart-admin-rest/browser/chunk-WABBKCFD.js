import{a as Ce}from"./chunk-Q3KTT2IO.js";import{A as me,Da as ve,E as fe,Ec as ye,J as he,Ua as Ae,a as Q,ja as X,k as q,ka as we,l as le,lb as _e,m as M,n as ce,o as de,p as J,qb as ge,y as pe,z as ue}from"./chunk-AYDE6MWJ.js";import{$ as T,Ea as n,Fa as h,Jc as oe,Ka as Z,Lc as ae,Nb as g,Ob as y,Oc as z,Qa as ee,Rb as ie,Rc as be,Sa as b,Ua as $,V as S,Wa as F,a as _,aa as R,ab as o,ac as se,b as I,bb as l,ca as x,cb as V,f as Y,ga as D,gb as O,ha as P,jb as w,kb as W,n as d,nb as te,oa as m,pa as f,rb as B,sb as N,tb as U,tc as re,vb as p,wb as A,xb as L,xc as ne}from"./chunk-RFGELG3T.js";var C=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Question] Get";let s=e;return s})(),Se=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Question] Edit";let s=e;return s})(),G=(()=>{let e=class e{constructor(t,i){this.payload=t,this.id=i}};e.type="[Question] put";let s=e;return s})(),H=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Question] Delete";let s=e;return s})(),K=(()=>{let e=class e{constructor(t){this.ids=t}};e.type="[Question] Delete All";let s=e;return s})();var xe=(()=>{let e=class e{constructor(t){this.http=t}getQuestionAnswers(t){return this.http.get(`${Q.URL}/question-and-answer`,{params:t})}editQuestionAnswers(t){return this.http.get(`${Q.URL}/question-and-answer/${t}`)}updateQuestionAnswers(t,i){return this.http.put(`${Q.URL}/question-and-answer/${t}`,i)}deleteQuestionAnswers(t){return this.http.delete(`${Q.URL}/question-and-answer/${t}`)}deleteAllQuestionAnswers(t){return this.http.post(`${Q.URL}/question-and-answer/deleteAll`,{ids:t})}};e.\u0275fac=function(i){return new(i||e)(x(ne))},e.\u0275prov=T({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var v,c=(v=class{constructor(e,r,t){this.store=e,this.notificationService=r,this.questionsAnswersService=t}static questionAnswers(e){return e.question}static selectedQuestionAnswers(e){return e.selectedQuestion}getQuestionAnswers(e,r){return this.questionsAnswersService.getQuestionAnswers(r.payload).pipe(S({next:t=>{e.patchState({question:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}edit(e,{id:r}){return this.questionsAnswersService.editQuestionAnswers(r).pipe(S({next:t=>{let i=e.getState();e.patchState(I(_({},i),{selectedQuestion:t}))},error:t=>{throw new Error(t?.error?.message)}}))}update(e,{payload:r,id:t}){return this.questionsAnswersService.updateQuestionAnswers(t,r).pipe(S({next:i=>{if(typeof i=="object"){let a=e.getState(),u=[...a.question.data],ke=u.findIndex(Ie=>Ie.id===t);u[ke]=i,e.patchState(I(_({},a),{question:{data:u,total:a.question.total}}))}},complete:()=>{this.notificationService.showSuccess("Q&A Updated Successfully")},error:i=>{throw new Error(i?.error?.message)}}))}delete(e,{id:r}){return this.questionsAnswersService.deleteQuestionAnswers(r).pipe(S({next:()=>{this.store.dispatch(new C({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Q&A Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}deleteAll(e,{ids:r}){return this.questionsAnswersService.deleteAllQuestionAnswers(r).pipe(S({next:()=>{this.store.dispatch(new C({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Q&A Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}},v.\u0275fac=function(r){return new(r||v)(x(q),x(ve),x(xe))},v.\u0275prov=T({token:v,factory:v.\u0275fac}),v);d([M(C)],c.prototype,"getQuestionAnswers",null);d([M(Se)],c.prototype,"edit",null);d([M(G)],c.prototype,"update",null);d([M(H)],c.prototype,"delete",null);d([M(K)],c.prototype,"deleteAll",null);d([J()],c,"questionAnswers",null);d([J()],c,"selectedQuestionAnswers",null);c=d([ce({name:"question",defaults:{question:{data:[],total:0},selectedQuestion:null}})],c);var je=["answersModal"];function Ee(s,e){if(s&1){let r=O();o(0,"div",1)(1,"h3",2),p(2),g(3,"translate"),l(),o(4,"app-button",3),w("click",function(){let i=m(r).$implicit;return f(i.dismiss("Cross click"))}),V(5,"i",4),l()(),o(6,"div",5)(7,"div",6)(8,"table",7)(9,"tbody")(10,"tr")(11,"td",8),p(12),g(13,"translate"),l(),o(14,"td",9),p(15),l()(),o(16,"tr")(17,"td",8),p(18),g(19,"translate"),l(),o(20,"td",9),V(21,"textarea",10),g(22,"translate"),l()()()()(),o(23,"div")(24,"div",11)(25,"app-button",12),w("click",function(){let i=m(r).$implicit;return f(i.dismiss("cancel"))}),p(26),g(27,"translate"),l(),o(28,"app-button",12),w("click",function(){m(r);let i=W();return f(i.submit())}),p(29),g(30,"translate"),l()()()()}if(s&2){let r=W();n(2),A(y(3,18,"answers")),n(2),F("btn btn-close"),b("spinner",!1)("id","payout_close_btn"),n(8),A(y(13,20,"question")),n(3),L(" ",r.qna==null?null:r.qna.question," "),n(3),A(y(19,22,"answers")),n(3),te("placeholder",y(22,24,"enter_answers")),b("formControl",r.answers),n(4),F("btn-md fw-bold btn btn-secondary"),b("id","close_answers_modal_btn"),n(),L(" ",y(27,26,"close")," "),n(2),F("btn-theme btn-md fw-bold btn"),b("id","submit_answers_btn"),n(),L(" ",y(30,28,"submit")," ")}}var qe=(()=>{let e=class e{constructor(t,i){this.modalService=t,this.store=i,this.modalOpen=!1,this.answers=new fe("",[ue.required])}openModal(t){return Y(this,null,function*(){this.modalOpen=!0,this.qna=t,t.answer?this.answers.patchValue(t.answer):this.answers.patchValue(""),this.modalService.open(this.AnswersModal,{ariaLabelledBy:"Payout-Modal",centered:!0,windowClass:"theme-modal text-center"}).result.then(i=>{`${i}`,this.closeResult=`Closed with: ${i}`},i=>{this.closeResult=`Dismissed ${this.getDismissReason(i)}`})})}getDismissReason(t){return t===X.ESC?"by pressing ESC":t===X.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${t}`}submit(){if(this.answers.markAllAsTouched(),this.answers.valid){let t={question:this.qna.question,answer:this.answers.value,product_id:this.qna.product_id};this.store.dispatch(new G(t,this.qna.id)).subscribe({complete:()=>{this.modalService.dismissAll()}})}}ngOnDestroy(){this.modalOpen&&this.modalService.dismissAll()}};e.\u0275fac=function(i){return new(i||e)(h(we),h(q))},e.\u0275cmp=D({type:e,selectors:[["app-answers-modal"]],viewQuery:function(i,a){if(i&1&&B(je,5),i&2){let u;N(u=U())&&(a.AnswersModal=u.first)}},decls:2,vars:0,consts:[["answersModal",""],[1,"modal-header"],[1,"mb-1","fw-semibold"],[3,"click","spinner","id"],[1,"ri-close-line"],[1,"modal-body","qa-modal"],[1,"border","rounded-3","mb-4","dark-border-color"],[1,"table","all-package","theme-table","no-footer"],[1,"text-start","fw-semibold"],[1,"text-start"],[1,"form-control",3,"placeholder","formControl"],[1,"button-box"],[3,"click","id"]],template:function(i,a){i&1&&ee(0,Ee,31,30,"ng-template",null,0,ie)},dependencies:[pe,me,he,Ae,be]});let s=e;return s})();var Re=["answersModal"],k=class k{constructor(e,r,t,i,a){this.store=e,this.renderer=r,this.router=t,this.activatedRoute=i,this.document=a,this.filter={},this.tableConfig={columns:[{title:"Question",dataField:"question"},{title:"product",dataField:"product_name"},{title:"created_at",dataField:"created_at",type:"date",sortable:!0,sort_direction:"desc"},{title:"status",dataField:"status",sortable:!0,sort_direction:"desc"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"store.edit"},{label:"Delete",actionToPerform:"delete",icon:"ri-delete-bin-line",permission:"store.destroy"}],data:[],total:0}}ngOnInit(){this.questionAnswers$.subscribe(e=>{this.total=e.total;let r=e.data.filter(t=>(t.product_name=t.product.name,t.status=t?.answer?'<div class="status-approved"><span>Repelled</span></div>':'<div class="status-pending"><span>Pending</span></div>',t));this.tableConfig.data=r||[],this.tableConfig.total=e&&e?.total?e?.total:0}),this.activatedRoute.queryParams.subscribe(e=>{this.filter=I(_({},this.filter),{status:e.status?e.status:""}),this.selectedStatus=e.status,this.store.dispatch(new C(this.filter))})}onTableChange(e){let r=this.selectedStatus?this.selectedStatus:"";this.filter=_(_({},this.filter),e),this.filter.status=r,this.store.dispatch(new C(this.filter))}onActionClicked(e){e.actionToPerform=="edit"?this.AnswersModal.openModal(e.data):e.actionToPerform=="delete"?this.delete(e.data):e.actionToPerform=="deleteAll"&&this.deleteAll(e.data)}filterOrder(e){this.renderer.addClass(this.document.body,"loader-none"),this.router.navigate([],{queryParams:{status:e||null},queryParamsHandling:"merge"})}delete(e){this.store.dispatch(new H(e.id))}deleteAll(e){this.store.dispatch(new K(e))}};k.\u0275fac=function(r){return new(r||k)(h(q),h(Z),h(ae),h(oe),h(se))},k.\u0275cmp=D({type:k,selectors:[["app-questions-answers"]],viewQuery:function(r,t){if(r&1&&B(Re,5),r&2){let i;N(i=U())&&(t.AnswersModal=i.first)}},decls:15,vars:13,consts:[["answersModal",""],[3,"gridClass","title"],[3,"tableChanged","action","tableConfig","hasCheckbox"],["advanceFilter","",1,"show-box","mb-4","d-block"],[1,"order-tab-content"],["href","javascript:void(0)",3,"click"]],template:function(r,t){if(r&1){let i=O();o(0,"app-page-wrapper",1)(1,"app-table",2),w("tableChanged",function(u){return m(i),f(t.onTableChange(u))})("action",function(u){return m(i),f(t.onActionClicked(u))}),o(2,"div",3)(3,"ul",4)(4,"li")(5,"a",5),w("click",function(){return m(i),f(t.filterOrder(""))}),p(6),l()(),o(7,"li")(8,"a",5),w("click",function(){return m(i),f(t.filterOrder("pending"))}),p(9),l()(),o(10,"li")(11,"a",5),w("click",function(){return m(i),f(t.filterOrder("answered"))}),p(12),l()()()()()(),V(13,"app-answers-modal",null,0)}r&2&&(b("gridClass","col-sm-12")("title","Q&A"),n(),b("tableConfig",t.tableConfig)("hasCheckbox",!0),n(3),$("active",!t.selectedStatus),n(2),A("All"),n(),$("active",t.selectedStatus==="pending"?"active":""),n(2),A("pending"),n(),$("active",t.selectedStatus==="answered"?"active":""),n(2),A("answered"))},dependencies:[ge,_e,qe]});var E=k;d([de(c.questionAnswers)],E.prototype,"questionAnswers$",void 0);var De=[{path:"",component:E}],Me=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=P({type:e}),e.\u0275inj=R({imports:[z.forChild(De),z]});let s=e;return s})();var St=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=P({type:e}),e.\u0275inj=R({imports:[re,Me,ye,le.forFeature([c,Ce])]});let s=e;return s})();export{St as QuestionsAnswersModule};
