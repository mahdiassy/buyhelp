import{a as U}from"./chunk-X62LHEF6.js";import{a as p,m as i,n as v,p as O}from"./chunk-AYDE6MWJ.js";import{$ as w,Lc as S,V as d,a as h,b as m,ca as y,n as c,xc as f}from"./chunk-RFGELG3T.js";var g=(()=>{let t=class t{constructor(e){this.payload=e}};t.type="[Order] Get";let r=t;return r})(),k=(()=>{let t=class t{constructor(e){this.id=e}};t.type="[Order] User";let r=t;return r})(),x=(()=>{let t=class t{constructor(e){this.id=e}};t.type="[Order] View";let r=t;return r})(),b=(()=>{let t=class t{constructor(e){this.payload=e}};t.type="[Order] Checkout";let r=t;return r})(),j=(()=>{let t=class t{constructor(e){this.payload=e}};t.type="[Order] Place";let r=t;return r})(),I=(()=>{let t=class t{constructor(e,s){this.id=e,this.payload=s}};t.type="[Order] Update Status";let r=t;return r})(),R=(()=>{let t=class t{constructor(e){this.payload=e}};t.type="[Order] Invoice";let r=t;return r})(),L=(()=>{let t=class t{constructor(){}};t.type="[Order] Clear";let r=t;return r})();var $=(()=>{let t=class t{constructor(e){this.http=e}getOrders(e){return this.http.get(`${p.URL}/order`,{params:e})}viewOrder(e){return this.http.get(`${p.URL}/order/${e}`)}checkout(e){return this.http.post(`${p.URL}/checkout`,e)}placeOrder(e){return this.http.post(`${p.URL}/order`,e)}updateOrderStatus(e,s){return this.http.put(`${p.URL}/order/${e}`,s)}downloadInvoice(e){let s={};return this.http.post(`${p.URL}/order/invoice`,e,{responseType:"blob"})}};t.\u0275fac=function(s){return new(s||t)(y(f))},t.\u0275prov=w({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var n,a=(n=class{constructor(t,o,e){this.router=t,this.orderService=o,this.userService=e}static order(t){return t.order}static selectedUser(t){return t.selectedUser}static selectedOrder(t){return t.selectedOrder}static checkout(t){return t.checkout}getOrders(t,o){return this.orderService.getOrders(o?.payload).pipe(d({next:e=>{t.patchState({order:{data:e.data,total:e?.total?e?.total:e.data?.length}})},error:e=>{throw new Error(e?.error?.message)}}))}selectUser(t,{id:o}){return this.userService.editUser(o).pipe(d({next:e=>{let s=t.getState();t.patchState(m(h({},s),{selectedUser:e,checkout:null}))},error:e=>{throw new Error(e?.error?.message)}}))}viewOrder(t,{id:o}){return this.orderService.viewOrder(o).pipe(d({next:e=>{let s=t.getState();t.patchState(m(h({},s),{selectedOrder:e}))},error:e=>{throw new Error(e?.error?.message)}}))}checkout(t,o){return this.orderService.checkout(o?.payload).pipe(d({next:e=>{let s=t.getState();t.patchState(m(h({},s),{checkout:e}))},error:e=>{throw new Error(e?.error?.message)}}))}placeOrder(t,o){return this.orderService.placeOrder(o?.payload).pipe(d({next:e=>{this.router.navigateByUrl(`/order/details/${e.order_number}`)},error:e=>{throw new Error(e?.error?.message)}}))}updateOrderStatus(t,{id:o,payload:e}){return this.orderService.updateOrderStatus(o,e).pipe(d({next:s=>{if(typeof s=="object"){let u=t.getState(),l=[...u.order.data],E=l.findIndex(B=>B.id===o);l[E]=s,t.patchState(m(h({},u),{order:{data:l,total:u.order.total},selectedOrder:s}))}},error:s=>{throw new Error(s?.error?.message)}}))}downloadInvoice(t,o){return this.orderService.downloadInvoice(o.payload).pipe(d({next:e=>{let s=new Blob([e],{type:"pdf"}),u=window.URL.createObjectURL(s),l=document.createElement("a");l.href=u,l.download=`invoice-${o.payload.order_number}.pdf`,l.click(),window.URL.revokeObjectURL(u)},error:e=>{throw new Error(e?.error?.message)}}))}clear(t){let o=t.getState();t.patchState(m(h({},o),{selectedUser:null,checkout:null}))}},n.\u0275fac=function(o){return new(o||n)(y(S),y($),y(U))},n.\u0275prov=w({token:n,factory:n.\u0275fac}),n);c([i(g)],a.prototype,"getOrders",null);c([i(k)],a.prototype,"selectUser",null);c([i(x)],a.prototype,"viewOrder",null);c([i(b)],a.prototype,"checkout",null);c([i(j)],a.prototype,"placeOrder",null);c([i(I)],a.prototype,"updateOrderStatus",null);c([i(R)],a.prototype,"downloadInvoice",null);c([i(L)],a.prototype,"clear",null);c([O()],a,"order",null);c([O()],a,"selectedUser",null);c([O()],a,"selectedOrder",null);c([O()],a,"checkout",null);a=c([v({name:"order",defaults:{order:{data:[],total:0},selectedOrder:null,selectedUser:null,checkout:null}})],a);export{g as a,k as b,x as c,b as d,j as e,I as f,R as g,L as h,a as i};
