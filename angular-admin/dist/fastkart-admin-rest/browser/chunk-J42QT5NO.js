import{Da as W,Fa as Z,Ia as Y,T as $,Va as J,Wa as Q,Xa as X,Ya as _,Za as ee,_a as C,a as v,bb as te,k as K,m as p,n as V,p as w,v as q,w as G}from"./chunk-AYDE6MWJ.js";import{$ as g,Fa as m,Fb as z,La as M,Lc as F,Ra as T,V as f,_ as O,a as S,aa as b,b as k,ba as d,ca as a,ga as L,ha as E,ia as P,j as A,jb as N,n as c,p as I,uc as U,wa as B,xa as j,xc as H,ya as D,z as R}from"./chunk-RFGELG3T.js";var ae=new d("recaptcha-language"),ce=new d("recaptcha-base-url"),he=new d("recaptcha-nonce-tag"),ue=new d("recaptcha-settings"),le=new d("recaptcha-v3-site-key"),de=new d("recaptcha-loader-options");function pe(r,e,o,{url:t,lang:i,nonce:s}={}){window.ng2recaptchaloaded=()=>{o(grecaptcha)};let n=document.createElement("script");n.innerHTML="";let{url:u,nonce:x}=e(new URL(t||"https://www.google.com/recaptcha/api.js"));u.searchParams.set("render",r==="explicit"?r:r.key),u.searchParams.set("onload","ng2recaptchaloaded"),u.searchParams.set("trustedtypes","true"),i&&u.searchParams.set("hl",i),n.src=u.href;let y=x||s;y&&n.setAttribute("nonce",y),n.async=!0,n.defer=!0,document.head.appendChild(n)}function fe({v3SiteKey:r,onBeforeLoad:e,onLoaded:o}){let t=r?{key:r}:"explicit";re.loadScript(t,e,o)}var re={loadScript:pe,newLoadScript:fe};function ge(r){return r.asObservable().pipe(R(e=>e!==null))}var oe=(()=>{let e=class e{constructor(t,i,s,n,u,x){this.platformId=t,this.language=i,this.baseUrl=s,this.nonce=n,this.v3SiteKey=u,this.options=x;let y=this.init();this.ready=y?ge(y):I()}init(){if(e.ready)return e.ready;if(!U(this.platformId))return;let t=new A(null);return e.ready=t,re.newLoadScript({v3SiteKey:this.v3SiteKey,onBeforeLoad:i=>{if(this.options?.onBeforeLoad)return this.options.onBeforeLoad(i);let s=new URL(this.baseUrl??i);return this.language&&s.searchParams.set("hl",this.language),{url:s,nonce:this.nonce}},onLoaded:i=>{let s=i;this.options?.onLoaded&&(s=this.options.onLoaded(i)),t.next(s)}}),t}};e.ready=null,e.\u0275fac=function(i){return new(i||e)(a(D),a(ae,8),a(ce,8),a(he,8),a(le,8),a(de,8))},e.\u0275prov=g({token:e,factory:e.\u0275fac});let r=e;return r})(),me=0,ve=(()=>{let e=class e{constructor(t,i,s,n){this.elementRef=t,this.loader=i,this.zone=s,this.id=`ngrecaptcha-${me++}`,this.errorMode="default",this.resolved=new j,this.error=new j,this.errored=new j,n&&(this.siteKey=n.siteKey,this.theme=n.theme,this.type=n.type,this.size=n.size,this.badge=n.badge)}ngAfterViewInit(){this.subscription=this.loader.ready.subscribe(t=>{t!=null&&t.render instanceof Function&&(this.grecaptcha=t,this.renderRecaptcha())})}ngOnDestroy(){this.grecaptchaReset(),this.subscription&&this.subscription.unsubscribe()}execute(){this.size==="invisible"&&(this.widget!=null?this.grecaptcha.execute(this.widget):this.executeRequested=!0)}reset(){this.widget!=null&&(this.grecaptcha.getResponse(this.widget)&&this.resolved.emit(null),this.grecaptchaReset())}get __unsafe_widgetValue(){return this.widget!=null?this.grecaptcha.getResponse(this.widget):null}expired(){this.resolved.emit(null)}onError(t){this.error.emit(t),this.errored.emit(t)}captchaResponseCallback(t){this.resolved.emit(t)}grecaptchaReset(){this.widget!=null&&this.zone.runOutsideAngular(()=>this.grecaptcha.reset(this.widget))}renderRecaptcha(){let t={badge:this.badge,callback:i=>{this.zone.run(()=>this.captchaResponseCallback(i))},"expired-callback":()=>{this.zone.run(()=>this.expired())},sitekey:this.siteKey,size:this.size,tabindex:this.tabIndex,theme:this.theme,type:this.type};this.errorMode==="handled"&&(t["error-callback"]=(...i)=>{this.zone.run(()=>this.onError(i))}),this.widget=this.grecaptcha.render(this.elementRef.nativeElement,t),this.executeRequested===!0&&(this.executeRequested=!1,this.execute())}};e.\u0275fac=function(i){return new(i||e)(m(B),m(oe),m(M),m(ue,8))},e.\u0275cmp=L({type:e,selectors:[["re-captcha"]],hostVars:1,hostBindings:function(i,s){i&2&&T("id",s.id)},inputs:{id:"id",siteKey:"siteKey",theme:"theme",type:"type",size:"size",tabIndex:"tabIndex",badge:"badge",errorMode:"errorMode"},outputs:{resolved:"resolved",error:"error",errored:"errored"},exportAs:["reCaptcha"],decls:0,vars:0,template:function(i,s){},encapsulation:2});let r=e;return r})(),se=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=E({type:e}),e.\u0275inj=b({});let r=e;return r})(),Me=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=E({type:e}),e.\u0275inj=b({providers:[oe],imports:[se]});let r=e;return r})();var Te=(()=>{let e=class e{constructor(t){this.host=t,this.requiresControllerReset=!1}writeValue(t){t?this.host.__unsafe_widgetValue!==t&&!this.host.__unsafe_widgetValue&&(this.requiresControllerReset=!0):this.host.reset()}registerOnChange(t){this.onChange=t,this.requiresControllerReset&&(this.requiresControllerReset=!1,this.onChange(null))}registerOnTouched(t){this.onTouched=t}onResolve(t){this.onChange&&this.onChange(t),this.onTouched&&this.onTouched()}};e.\u0275fac=function(i){return new(i||e)(m(ve))},e.\u0275dir=P({type:e,selectors:[["re-captcha","formControlName",""],["re-captcha","formControl",""],["re-captcha","ngModel",""]],hostBindings:function(i,s){i&1&&N("resolved",function(u){return s.onResolve(u)})},features:[z([{multi:!0,provide:G,useExisting:O(()=>e)}])]});let r=e;return r})(),Ne=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=E({type:e}),e.\u0275inj=b({imports:[$,se]});let r=e;return r})();var ne=(()=>{let e=class e{constructor(t){this.http=t}login(t){return this.http.post(`${v.URL}/login`,t)}forgotPassword(t){return this.http.post(`${v.URL}/forgot-password`,t)}verifyEmailOtp(t){return this.http.post(`${v.URL}/verify-token`,t)}updatePassword(t){return this.http.post(`${v.URL}/update-password`,t)}logout(){return this.http.post(`${v.URL}/logout`,{})}};e.\u0275fac=function(i){return new(i||e)(a(H))},e.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var l,h=(l=class{constructor(e,o,t,i){this.store=e,this.router=o,this.notificationService=t,this.authService=i}static accessToken(e){return e.access_token}static isAuthenticated(e){return!!e.access_token}static email(e){return e.email}static token(e){return e.token}login(e,o){return this.notificationService.notification=!1,this.authService.login(o.payload).pipe(f({next:t=>{e.patchState({access_token:t.access_token,permissions:[]}),this.store.dispatch(new te),this.store.dispatch(new Z),this.store.dispatch(new Y)},error:t=>{throw new Error(t?.error?.message)}}))}forgotPassword(e,o){return this.notificationService.notification=!1,this.authService.forgotPassword(o.payload).pipe(f({next:()=>{let t=e.getState();e.patchState(k(S({},t),{email:o.payload.email}))},error:t=>{throw new Error(t?.error?.message)}}))}verifyEmail(e,o){return this.notificationService.notification=!1,this.authService.verifyEmailOtp(o.payload).pipe(f({next:()=>{let t=e.getState();e.patchState(k(S({},t),{token:o.payload.token}))},error:t=>{throw new Error(t?.error?.message)}}))}updatePassword(e,o){return this.notificationService.notification=!1,this.authService.updatePassword(o.payload).pipe(f({error:t=>{throw new Error(t?.error?.message)}}))}logout(e){return this.notificationService.notification=!1,this.authService.logout().pipe(f({next:o=>{this.store.dispatch(new C).subscribe({complete:()=>{this.router.navigate(["/auth/login"])}})},error:o=>{throw new Error(o?.error?.message)}}))}authClear(e){e.patchState({email:"",token:"",access_token:null,permissions:[]}),this.store.dispatch(new q)}},l.\u0275fac=function(o){return new(o||l)(a(K),a(F),a(W),a(ne))},l.\u0275prov=g({token:l,factory:l.\u0275fac}),l);c([p(J)],h.prototype,"login",null);c([p(Q)],h.prototype,"forgotPassword",null);c([p(X)],h.prototype,"verifyEmail",null);c([p(_)],h.prototype,"updatePassword",null);c([p(ee)],h.prototype,"logout",null);c([p(C)],h.prototype,"authClear",null);c([w()],h,"accessToken",null);c([w()],h,"isAuthenticated",null);c([w()],h,"email",null);c([w()],h,"token",null);h=c([V({name:"auth",defaults:{email:"",token:"",access_token:"",permissions:[]}})],h);export{ue as a,ve as b,Me as c,Te as d,Ne as e,h as f};
