import{Da as j,a as l,cb as E,k as $,m as u,n as U,p as g}from"./chunk-AYDE6MWJ.js";import{$ as v,V as n,a as d,b as h,ca as f,n as i,xc as x}from"./chunk-RFGELG3T.js";var w=(()=>{let t=class t{constructor(e){this.payload=e}};t.type="[Store] Get";let o=t;return o})(),b=(()=>{let t=class t{constructor(e){this.payload=e}};t.type="[Store] Create";let o=t;return o})(),A=(()=>{let t=class t{constructor(e){this.id=e}};t.type="[Store] Edit";let o=t;return o})(),I=(()=>{let t=class t{constructor(e,r){this.payload=e,this.id=r}};t.type="[Store] Update";let o=t;return o})(),L=(()=>{let t=class t{constructor(e,r){this.id=e,this.status=r}};t.type="[Store] Update Status";let o=t;return o})(),R=(()=>{let t=class t{constructor(e,r){this.id=e,this.status=r}};t.type="[Store] Approve Status";let o=t;return o})(),D=(()=>{let t=class t{constructor(e){this.id=e}};t.type="[Store] Delete";let o=t;return o})(),C=(()=>{let t=class t{constructor(e){this.ids=e}};t.type="[Store] Delete All";let o=t;return o})();var k=(()=>{let t=class t{constructor(e){this.http=e}getStores(e){return this.http.get(`${l.URL}/store`,{params:e})}createStore(e){return this.http.post(`${l.URL.replace("/admin","")}/store`,e)}editStore(e){return this.http.get(`${l.URL}/store/${e}`)}updateStore(e,r){return this.http.put(`${l.URL}/store/${e}`,r)}updateStoreStatus(e,r){return this.http.put(`${l.URL}/store/${e}/${r}`,{})}approveStoreStatus(e,r){return this.http.put(`${l.URL}/store/approve/${e}/${r}`,{})}deleteStore(e){return this.http.delete(`${l.URL}/store/${e}`)}deleteAllStore(e){return this.http.post(`${l.URL}/store/deleteAll`,{ids:e})}};t.\u0275fac=function(r){return new(r||t)(f(x))},t.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var S,c=(S=class{constructor(t,s,e){this.store=t,this.notificationService=s,this.storeService=e}static store(t){return t.store}static stores(t){return t.store.data.map(s=>({label:s?.store_name,value:s?.id}))}static selectedStore(t){return t.selectedStore}getStores(t,s){return this.storeService.getStores(s.payload).pipe(n({next:e=>{t.patchState({store:{data:e.data,total:e?.total?e?.total:e.data?.length}})},error:e=>{throw new Error(e?.error?.message)}}))}create(t,s){return this.storeService.createStore(s.payload).pipe(n({next:e=>{let r=t.getState();t.patchState(h(d({},r),{store:{data:[...r.store.data,e],total:r?.store.total+1}}))},complete:()=>{this.notificationService.showSuccess("Store Created Successfully")},error:e=>{throw new Error(e?.error?.message)}}))}edit(t,{id:s}){return this.storeService.editStore(s).pipe(n({next:e=>{let r=t.getState();t.patchState(h(d({},r),{selectedStore:e}))},error:e=>{throw new Error(e?.error?.message)}}))}update(t,{payload:s,id:e}){return this.storeService.updateStore(e,s).pipe(n({next:r=>{if(typeof r=="object"){let a=t.getState(),p=[...a.store.data],m=p.findIndex(y=>y.id===e);p[m]=r,t.patchState(h(d({},a),{store:{data:p,total:a.store.total}}))}},complete:()=>{this.notificationService.showSuccess("Store Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}updateStatus(t,{id:s,status:e}){return this.storeService.updateStoreStatus(s,e).pipe(n({next:r=>{if(typeof r=="object"){let a=t.getState(),p=[...a.store.data],m=p.findIndex(y=>y.id===s);p[m]=r,t.patchState(h(d({},a),{store:{data:p,total:a.store.total}}))}},complete:()=>{this.notificationService.showSuccess("Store Status Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}approveStatus(t,{id:s,status:e}){return this.storeService.approveStoreStatus(s,e).pipe(n({next:r=>{if(typeof r=="object"){let a=t.getState(),p=[...a.store.data],m=p.findIndex(y=>y.id===s);p[m]=r,t.patchState(h(d({},a),{store:{data:p,total:a.store.total}})),this.store.dispatch(new E("/store",r?.total_in_approved_stores))}},complete:()=>{this.notificationService.showSuccess("Store Status Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}delete(t,{id:s}){return this.storeService.deleteStore(s).pipe(n({next:()=>{this.store.dispatch(new w({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Store Deleted Successfully")},error:e=>{throw new Error(e?.error?.message)}}))}deleteAll(t,{ids:s}){return this.storeService.deleteAllStore(s).pipe(n({next:()=>{let e=t.getState(),r=e.store.data.filter(a=>!s.includes(a.id));this.store.dispatch(new w({page:1,paginate:15})),t.patchState(h(d({},e),{store:{data:r,total:e.store.total-s.length}}))},complete:()=>{this.notificationService.showSuccess("Stores Deleted Successfully")},error:e=>{throw new Error(e?.error?.message)}}))}},S.\u0275fac=function(s){return new(s||S)(f($),f(j),f(k))},S.\u0275prov=v({token:S,factory:S.\u0275fac}),S);i([u(w)],c.prototype,"getStores",null);i([u(b)],c.prototype,"create",null);i([u(A)],c.prototype,"edit",null);i([u(I)],c.prototype,"update",null);i([u(L)],c.prototype,"updateStatus",null);i([u(R)],c.prototype,"approveStatus",null);i([u(D)],c.prototype,"delete",null);i([u(C)],c.prototype,"deleteAll",null);i([g()],c,"store",null);i([g()],c,"stores",null);i([g()],c,"selectedStore",null);c=i([U({name:"store",defaults:{store:{data:[],total:0},selectedStore:null}})],c);export{w as a,b,A as c,I as d,R as e,D as f,C as g,c as h};
