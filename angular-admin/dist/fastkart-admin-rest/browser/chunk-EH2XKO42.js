import{a as R}from"./chunk-X62LHEF6.js";import{Da as g,Ob as h,Pb as x,Qb as E,Rb as A,Sb as b,Tb as j,Ub as I,Vb as k,Wb as D,Xb as L,k as v,m as n,n as y,p as m}from"./chunk-AYDE6MWJ.js";import{$ as w,V as c,a as u,b as d,ca as S,n as o}from"./chunk-RFGELG3T.js";var l,a=(l=class{constructor(t,r,e){this.store=t,this.notificationService=r,this.userService=e}static user(t){return t.user}static users(t){return t.user.data.map(r=>({label:r?.name,value:r?.id}))}static selectedUser(t){return t.selectedUser}getUsers(t,r){return this.userService.getUsers(r?.payload).pipe(c({next:e=>{t.patchState({user:{data:e.data,total:e?.total?e?.total:e.data?.length}})},error:e=>{throw new Error(e?.error?.message)}}))}create(t,r){return this.userService.createUser(r.payload).pipe(c({next:e=>{let s=t.getState();t.patchState(d(u({},s),{user:{data:[...s.user.data,e],total:s?.user.total+1}}))},complete:()=>{this.notificationService.showSuccess("User Created Successfully")},error:e=>{throw new Error(e?.error?.message)}}))}edit(t,{id:r}){return this.userService.editUser(r).pipe(c({next:e=>{let s=t.getState();t.patchState(d(u({},s),{selectedUser:e}))},error:e=>{throw new Error(e?.error?.message)}}))}update(t,{payload:r,id:e}){return this.userService.updateUser(e,r).pipe(c({next:s=>{if(typeof s=="object"){let p=t.getState(),i=[...p.user.data],U=i.findIndex(f=>f.id===e);i[U]=s,t.patchState(d(u({},p),{user:{data:i,total:p.user.total}}))}},complete:()=>{this.notificationService.showSuccess("User Updated Successfully")},error:s=>{throw new Error(s?.error?.message)}}))}updateStatus(t,{id:r,status:e}){return this.userService.updateUserStatus(r,e).pipe(c({next:s=>{if(typeof s=="object"){let p=t.getState(),i=[...p.user.data],U=i.findIndex(f=>f.id==r);i[U]=s,t.patchState(d(u({},p),{user:{data:i,total:p.user.total}}))}},complete:()=>{this.notificationService.showSuccess("User Status Updated Successfully")},error:s=>{throw new Error(s?.error?.message)}}))}delete(t,{id:r}){return this.userService.deleteUser(r).pipe(c({next:()=>{this.store.dispatch(new h({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("User Deleted Successfully")},error:e=>{throw new Error(e?.error?.message)}}))}deleteAll(t,{ids:r}){return this.userService.deleteAllUser(r).pipe(c({next:()=>{this.store.dispatch(new h({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Users Deleted Successfully")},error:e=>{throw new Error(e?.error?.message)}}))}import(t,r){return this.userService.importUser(r.payload).pipe(c({next:e=>{this.store.dispatch(new h({page:1,paginate:15}))},error:e=>{throw new Error(e?.error?.message)}}))}export(t,r){return this.userService.exportUser().pipe(c({next:e=>{let s=new Blob([e],{type:"text/csv"}),p=window.URL.createObjectURL(s),i=document.createElement("a");i.href=p,i.download="users.csv",i.click(),window.URL.revokeObjectURL(p)},error:e=>{throw new Error(e?.error?.message)}}))}createUserAddress(t,r){return this.userService.createUserAddress(r.payload).pipe(c({complete:()=>{this.notificationService.showSuccess("Address Added Successfully")},error:e=>{throw new Error(e?.error?.message)}}))}},l.\u0275fac=function(r){return new(r||l)(S(v),S(g),S(R))},l.\u0275prov=w({token:l,factory:l.\u0275fac}),l);o([n(h)],a.prototype,"getUsers",null);o([n(x)],a.prototype,"create",null);o([n(E)],a.prototype,"edit",null);o([n(A)],a.prototype,"update",null);o([n(b)],a.prototype,"updateStatus",null);o([n(j)],a.prototype,"delete",null);o([n(I)],a.prototype,"deleteAll",null);o([n(k)],a.prototype,"import",null);o([n(D)],a.prototype,"export",null);o([n(L)],a.prototype,"createUserAddress",null);o([m()],a,"user",null);o([m()],a,"users",null);o([m()],a,"selectedUser",null);a=o([y({name:"user",defaults:{user:{data:[],total:0},selectedUser:null}})],a);export{a};
